```
# 致第三方开发者

## 第三方使用时的注意事项

### 关于 VOICEVOX 的基本操作

VOICEVOX 应用程序大致可以分为用户可见的 GUI（前端部分）和负责语音合成的引擎（后端部分）。通常，当 VOICEVOX 的 GUI 启动时，引擎会以不可见的形式（根据注册的多引擎数量）依次启动。第三方若要使用语音合成功能，需要访问在后台运行的引擎。

### 关于访问 VOICEVOX

要使用 VOICEVOX 的引擎，需要使用 API。除非有特殊原因，请避免通过 API 以外的方式访问。（例如，直接修改文件等操作不仅会大大增加引发故障的可能性，还可能导致 VOICEVOX 在预测试中未能验证的非预期行为。）

基本上，VOICEVOX 中用于语音合成所需的 API 都已提供，但如果存在 API 无法实现的功能/操作，建议在 VOICEVOX 的 Issue 页面提出 API 实现建议。

### 关于 API 访问地址

可以通过 HTTP 访问 API。

*   VOICEVOX 引擎默认使用的端口号是内部确定的（例如：50021/tcp）。
*   如果其他应用程序使用了相同的端口号，由于会发生冲突，VOICEVOX 将打开另一个端口。
*   最终打开的端口号，请参考信息文件进行确定。
*   动态更改端口号是 VOICEVOX v0.16 及更高版本的功能。

### 关于运行时信息文件（以下简称信息文件）

为了让第三方获取所需信息，VOICEVOX 会生成一个名为“信息文件”的文件。第三方开发者请首先参考此文件来确定访问地址。

此外，如果 VOICEVOX 内部的引擎重启，通信端口号可能会改变。如果在 API 使用过程中突然发生通信失败，请检查此文件是否已更新。

（请注意，旧版本的 VOICEVOX 未实现此文件生成功能。此外，也有一些版本不动态确定端口号。为了保持向下兼容性，请考虑没有此文件的情况。）

## 关于信息文件

### 文件位置

文件位于以下位置：

| 操作系统 | 文件路径 |
| -------- | -------- |
| Windows  | C:\Users\（用户名）\AppData\Roaming\voicevox\runtime-info.json |
| MacOS    | /Users/（用户名）/Library/Application Support/voicevox/runtime-info.json |

请注意，根据 Windows 的配置文件设置，上述文件的位置可能会有所更改。为了准确确定位置，请使用环境变量 `APPDATA` 来确定 Roaming 文件夹的位置。

### 文件内容及含义

文件本身是 JSON 格式。其结构如下所示。

```JSONC
{
  //[string] VOICEVOX 的版本号
  "appVersion": "xxx.yyy.zzz",

  //[number] 文件结构版本（每次规范变更时递增）
  "formatVersion": 1,

  //引擎数据（根据启动数量）
  "engineInfos": [
    {
      //[string] 引擎别名
      "name": "engine1",
      
      //[string] API 端点
      "url": "http://127.0.0.1:50021",

      //[UUID] 用于引擎识别的 UUID
      "uuid": "00000000-0000-0000-0000-000000000001",
    },
    {
      "name": "engine2",
      "url": "http://127.0.0.1:50121",
      "uuid": "00000000-0000-0000-0000-000000000002",
    },
  ]
}
```

### 生成时机

*   在引擎启动（或重启）时，文件会被生成和更新。
*   如果因某种原因无法获取文件写入权限，则不会更新。（例如，在更新时其他工具正在打开该文件）
*   此生成时机是文件版本 1 的实现，在开发过程中可能会发生变化。
```